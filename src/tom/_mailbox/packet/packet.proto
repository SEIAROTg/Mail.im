syntax = "proto3";

message PacketId {
    int64 seq = 1;
    uint64 attempt = 2;
}

message PacketBody {
    PacketId id = 1;
    repeated PacketId acks = 2;
    bytes payload = 1000;
}

message PlainPacket {
    bool is_syn = 1;
    PacketBody body = 1000;
}

message SecurePacket {
    bool is_syn = 1;
    bytes dh_pub = 2;
    uint64 n = 3;
    uint64 pn = 4;
    bytes body = 1000;
}
